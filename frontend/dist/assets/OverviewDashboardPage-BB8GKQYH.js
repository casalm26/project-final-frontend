import{j as e,r as x,b as N,L as p}from"./index-CJti3Ljs.js";import{C as v,a as j,b,c as ae,d as K,e as se}from"./ChartComponents-DrKBmeTW.js";import{c as G,R as X,P as oe,a as ie,C as ne,T as Y,B as le,b as de,X as ce,Y as xe,d as he,u as me,e as ge,E as k}from"./useTreeData-SdKKrI-_.js";import{F as ue}from"./ForestValueAppreciationChart-CaxHH2-1.js";import{u as ve,D as je,a as be,G as pe}from"./useSidebarState-ANivPgkY.js";import{E as ke}from"./ExportButton-BlNJcB6K.js";import"./vendor-BtP0CW_r.js";import"./with-selector-C5k5o92S.js";import"./treeService-Cy-UAXFz.js";import"./DarkModeToggle-C6MT5bvb.js";import"./IconButton-DbV4qPVt.js";import"./forestService-DvXcQtLH.js";import"./dataService-2Ma-xxGM.js";const f=({icon:s,title:a,value:n,color:o="green"})=>{const l={green:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",blue:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",yellow:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600 dark:text-yellow-400",purple:"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400"};return e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg ${l[o]}`,children:s}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:a}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n})]})]})})},q=(s="line")=>x.useMemo(()=>({...{margin:{top:5,right:30,left:20,bottom:5},gridProps:{strokeDasharray:"3 3",stroke:"#f3f4f6"},axisProps:{stroke:"#6b7280",fontSize:12}},...{line:{strokeWidth:3,dot:{strokeWidth:2,r:4},activeDot:{r:6,strokeWidth:2}},bar:{radius:[4,4,0,0]},pie:{innerRadius:60,outerRadius:80,paddingAngle:5}}[s]}),[s]),J=(s,a={})=>{const[n,o]=x.useState(null),[l,r]=x.useState(!0),[d,i]=x.useState(null),u=x.useMemo(()=>a,[a==null?void 0:a.forestId,a==null?void 0:a.startDate,a==null?void 0:a.endDate,a==null?void 0:a.species]),h=x.useCallback(async()=>{try{r(!0),i(null);const m=await s(u);o(m.data)}catch(m){console.error("Error fetching chart data:",m),i(m.message||"Failed to fetch chart data")}finally{r(!1)}},[s,u]);x.useEffect(()=>{h()},[h]);const c=x.useCallback(()=>{h()},[h]);return{data:n,loading:l,error:d,refresh:c}},fe=(s={})=>J(G.getSurvivalRate,s),Ne=(s={})=>J(G.getCO2Absorption,s),ye=({filters:s={}})=>{var u,h;const{data:a,loading:n,error:o}=fe(s),l=((u=a==null?void 0:a.chartData)==null?void 0:u.length)>0&&((h=a.chartData[a.chartData.length-1])==null?void 0:h.survivalRate)||0,r={survived:l,lost:100-l},d=q("pie"),i=[{name:"Survived",value:r.survived,color:"#10b981"},{name:"Lost",value:r.lost,color:"#ef4444"}];return n?e.jsxs(v,{children:[e.jsx(j,{children:e.jsx(b,{children:"Tree Survival Rate"})}),e.jsx("div",{className:"flex justify-center items-center h-48",children:e.jsx(N,{size:"32px",text:"Loading chart data..."})})]}):o?e.jsxs(v,{children:[e.jsx(j,{children:e.jsx(b,{children:"Tree Survival Rate"})}),e.jsx("div",{className:"flex justify-center items-center h-48",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Error loading chart data"}),e.jsx("p",{className:"text-sm text-gray-500",children:o})]})})]}):e.jsxs(v,{children:[e.jsx(j,{children:e.jsx(b,{children:"Tree Survival Rate"})}),e.jsx(ae,{value:r.survived,label:"Survival Rate"}),e.jsx(X,{width:"100%",height:"100%",children:e.jsxs(oe,{children:[e.jsx(ie,{data:i,cx:"50%",cy:"50%",innerRadius:d.innerRadius,outerRadius:d.outerRadius,paddingAngle:d.paddingAngle,dataKey:"value",children:i.map((c,m)=>e.jsx(ne,{fill:c.color},`cell-${m}`))}),e.jsx(Y,{content:e.jsx(K,{valueFormatter:c=>`${c.toFixed(1)}%`})})]})}),e.jsx(se,{data:i})]})},we=({filters:s={}})=>{var d;const{data:a,loading:n,error:o}=Ne(s),l=((d=a==null?void 0:a.chartData)==null?void 0:d.map(i=>({period:i.period,co2:i.totalCO2||0})))||[],r=q("bar");return n?e.jsxs(v,{children:[e.jsx(j,{children:e.jsx(b,{children:"COâ‚‚ Absorption Over Time"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsx(N,{size:"32px",text:"Loading chart data..."})})]}):o?e.jsxs(v,{children:[e.jsx(j,{children:e.jsx(b,{children:"COâ‚‚ Absorption Over Time"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Error loading chart data"}),e.jsx("p",{className:"text-sm text-gray-500",children:o})]})})]}):e.jsxs(v,{children:[e.jsx(j,{children:e.jsx(b,{children:"COâ‚‚ Absorption Over Time"})}),e.jsx(X,{width:"100%",height:"100%",children:e.jsxs(le,{data:l,margin:r.margin,children:[e.jsx(de,{...r.gridProps}),e.jsx(ce,{dataKey:"period",...r.axisProps}),e.jsx(xe,{...r.axisProps,label:{value:"COâ‚‚ (tons)",angle:-90,position:"insideLeft",fontSize:12}}),e.jsx(Y,{content:e.jsx(K,{valueFormatter:i=>`COâ‚‚ Absorption: ${i.toFixed(1)} tons`})}),e.jsx(he,{dataKey:"co2",fill:"#8b5cf6",radius:r.radius})]})})]})},We=()=>{var w,C,L,S,E,F,D,M,R,A,O,$,B,T,W,z,P,V,I,H;const{sidebarOpen:s,toggleSidebar:a,closeSidebar:n}=ve(),[o,l]=x.useState({}),{stats:r,loading:d,error:i,refresh:u}=me(o);ge(o);const h=x.useCallback(t=>{l(t)},[]),c=t=>t?t.toLocaleString():"0",m=t=>t?`${t.toFixed(1)}%`:"0%",Q=t=>t?`${t.toFixed(1)}m`:"0m",U=t=>t?`${t.toFixed(1)}t`:"0t",Z=(t,g="SEK")=>t?new Intl.NumberFormat("sv-SE",{style:"currency",currency:g,minimumFractionDigits:0,maximumFractionDigits:0}).format(t):"0",y=(t,g="SEK")=>t?t>=1e6?`${(t/1e6).toFixed(1)}M ${g}`:t>=1e3?`${(t/1e3).toFixed(1)}K ${g}`:Z(t,g):"0",_=(t,g=100)=>t?`${t.toFixed(1)}/${g}`:"0",ee=()=>{console.log("Export started")},re=(t,g)=>{console.log(`Export completed: ${t} with ${g} records`)},te=t=>{console.error("Export error:",t)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[e.jsx(je,{onToggleSidebar:a}),e.jsxs("div",{className:"flex flex-1 lg:flex-row",children:[e.jsx(be,{isOpen:s,onClose:n}),e.jsx("main",{className:"flex-1 p-4 md:p-6 lg:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Forest Overview"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Monitor your forests with real-time insights. Navigate to specialized dashboards for detailed analysis."})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(ke,{onExportStart:ee,onExportComplete:re,onExportError:te})})]})}),e.jsx(pe,{onFiltersChange:h}),d?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(N,{text:"Loading dashboard overview..."})}):i?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-8",children:[e.jsxs("p",{className:"text-red-600",children:["Error loading dashboard statistics: ",i]}),e.jsx("button",{onClick:u,className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Try again"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"ðŸ“Š Core Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(f,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),title:"Total Trees",value:c((w=r==null?void 0:r.overview)==null?void 0:w.totalTrees),color:"green"}),e.jsx(f,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),title:"Survival Rate",value:m((C=r==null?void 0:r.overview)==null?void 0:C.survivalRate),color:"blue"}),e.jsx(f,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),title:"Avg Height",value:Q((L=r==null?void 0:r.height)==null?void 0:L.average),color:"yellow"}),e.jsx(f,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),title:"COâ‚‚ Absorbed",value:U((S=r==null?void 0:r.co2)==null?void 0:S.totalAbsorption),color:"purple"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"ðŸ’° Financial Summary"}),e.jsx(p,{to:"/dashboard/financial",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium text-sm",children:"View Full Financial Dashboard â†’"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(k,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),title:"Portfolio Value",value:y((F=(E=r==null?void 0:r.investor)==null?void 0:E.portfolio)==null?void 0:F.totalCurrentValue),subtitle:`${((M=(D=r==null?void 0:r.investor)==null?void 0:D.portfolio)==null?void 0:M.forestCount)||0} forests`,color:"green"}),e.jsx(k,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),title:"Average ROI",value:m((A=(R=r==null?void 0:r.investor)==null?void 0:R.roi)==null?void 0:A.averageROI),subtitle:`${y(($=(O=r==null?void 0:r.investor)==null?void 0:O.roi)==null?void 0:$.totalValueGain)} total gain`,color:"blue"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"ðŸŒ¿ Ecological Summary"}),e.jsx(p,{to:"/dashboard/ecological",className:"text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 font-medium text-sm",children:"View Full Ecological Dashboard â†’"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(k,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),title:"Biodiversity Index",value:_((T=(B=r==null?void 0:r.manager)==null?void 0:B.biodiversity)==null?void 0:T.averageIndex),subtitle:`${c((z=(W=r==null?void 0:r.manager)==null?void 0:W.biodiversity)==null?void 0:z.totalSpecies)} species tracked`,color:"green"}),e.jsx(k,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.94-.833-2.71 0L4.104 16.5c-.77.833.192 2.5 1.732 2.5z"})}),title:"Trees at Risk",value:c((V=(P=r==null?void 0:r.manager)==null?void 0:P.treesAtRisk)==null?void 0:V.total),subtitle:`${c((H=(I=r==null?void 0:r.manager)==null?void 0:I.treesAtRisk)==null?void 0:H.critical)} critical`,color:"red"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"ðŸš€ Detailed Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(p,{to:"/dashboard/financial",className:"block",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 p-6 border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg mr-4",children:e.jsx("svg",{className:"h-6 w-6 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Financial Dashboard"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Detailed investment analytics including ROI, carbon credit revenue, maintenance costs, and species economic performance."}),e.jsxs("div",{className:"flex items-center text-blue-600 dark:text-blue-400 font-medium",children:["View Financial Analytics",e.jsx("svg",{className:"h-4 w-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}),e.jsx(p,{to:"/dashboard/ecological",className:"block",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 p-6 border border-gray-200 dark:border-gray-700 hover:border-green-300 dark:hover:border-green-600",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg mr-4",children:e.jsx("svg",{className:"h-6 w-6 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Ecological Dashboard"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Comprehensive environmental impact analysis including biodiversity trends, ecological benefits, and conservation metrics."}),e.jsxs("div",{className:"flex items-center text-green-600 dark:text-green-400 font-medium",children:["View Ecological Analytics",e.jsx("svg",{className:"h-4 w-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"ðŸ“ˆ Key Performance Indicators"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(ye,{filters:o})}),e.jsx("div",{className:"col-span-1",children:e.jsx(ue,{filters:o})}),e.jsx("div",{className:"col-span-1 xl:col-span-1",children:e.jsx(we,{filters:o})})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"ðŸ“‹ Recent Activity"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"h-12 w-12 text-gray-400 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Recent activities and alerts will appear here"})]})})]})]})})]})]})};export{We as OverviewDashboardPage};
