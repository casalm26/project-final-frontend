import{A as F,f as I,r as c,j as e,b as O}from"./index-DpfrmWgL.js";import{u as P,D as R,a as L,G as M}from"./useSidebarState-BTIwZVt2.js";import"./vendor-BtP0CW_r.js";import"./DarkModeToggle-Bj6tWMn3.js";import"./IconButton-MG9jh3la.js";const h=new F,T={exportTreesCSV:(l={},r="trees_export.csv")=>h.downloadFile("/exports/trees/csv",l,r),exportTreesXLSX:(l={},r="trees_export.xlsx")=>h.downloadFile("/exports/trees/xlsx",l,r),exportForestAnalytics:(l={},r="forest_analytics.xlsx")=>h.downloadFile("/exports/forest-analytics",l,r),exportTrees:(l={})=>{const{format:r="csv",...x}=l,s=`trees_export_${new Date().toISOString().split("T")[0]}.${r}`,p=r==="xlsx"?"/exports/trees/xlsx":"/exports/trees/csv";return h.downloadFile(p,x,s)}},_=()=>{const{sidebarOpen:l,toggleSidebar:r}=P(),{showToast:x}=I(),[s,p]=c.useState({}),[o,j]=c.useState("csv"),[i,y]=c.useState("filtered"),[m,w]=c.useState({basicInfo:!0,location:!0,health:!0,measurements:!0,images:!1,genetics:!1,growthModel:!1,maintenance:!1,economicValue:!1,canopy:!1,ecologicalBenefits:!1,environmentalFactors:!1,metadata:!1}),[u,b]=c.useState(!1),k=c.useCallback(t=>{p(t)},[]),N=t=>{w(a=>({...a,[t]:!a[t]}))},C=async()=>{var t,a,d;b(!0);try{const n={format:o,scope:i,...m};i==="filtered"&&((t=s.dateRange)!=null&&t.startDate&&((a=s.dateRange)!=null&&a.endDate)&&(n.startDate=s.dateRange.startDate.toISOString(),n.endDate=s.dateRange.endDate.toISOString()),((d=s.selectedForests)==null?void 0:d.length)>0&&(n.forestIds=s.selectedForests.join(","))),await T.exportTrees(n),x("Export completed successfully!","success")}catch(n){console.error("Export failed:",n),x("Export failed. Please try again.","error")}finally{b(!1)}},S=()=>{var d,n,v;const t=Object.values(m).filter(f=>f).length;let a="all records";if(i==="filtered"&&(((d=s.selectedForests)==null?void 0:d.length)>0&&(a=`records from ${s.selectedForests.length} forest(s)`),(n=s.dateRange)!=null&&n.startDate&&((v=s.dateRange)!=null&&v.endDate))){const f=s.dateRange.startDate.toLocaleDateString(),D=s.dateRange.endDate.toLocaleDateString();a+=` between ${f} - ${D}`}return{includeCount:t,recordEstimate:a}},{includeCount:g,recordEstimate:E}=S();return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(R,{onMenuClick:r}),e.jsxs("div",{className:"flex",children:[e.jsx(L,{isOpen:l,onClose:()=>r(!1)}),e.jsx("main",{className:"flex-1 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Data Export"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Export your tree data in various formats with customizable options"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Scope"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"all",checked:i==="all",onChange:t=>y(t.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsxs("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"All Data"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"Export entire database without any filters"})]})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"filtered",checked:i==="filtered",onChange:t=>y(t.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsxs("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Filtered Data"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"Export only data matching the filters below"})]})]})]})]}),i==="filtered"&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:e.jsx(M,{onFiltersChange:k})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Data Fields to Include"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-md font-medium text-gray-800 dark:text-gray-200 mb-3",children:"Basic Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries({basicInfo:"Basic Info (ID, Species, Forest)",location:"Location (Coordinates)",health:"Health Status",measurements:"Measurements (Height, Diameter, CO₂)",images:"Image URLs"}).map(([t,a])=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:m[t],onChange:()=>N(t),className:"w-4 h-4 text-green-600 rounded focus:ring-green-500"}),e.jsx("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:a})]},t))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium text-gray-800 dark:text-gray-200 mb-3",children:"Advanced Data"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries({genetics:"Genetics (Seed Source, Cultivar, Diversity)",growthModel:"Growth Model (Predictions, Rate, Index)",maintenance:"Maintenance (Fertilization, Pruning, Damage)",economicValue:"Economic Value (Timber, Carbon Credits)",canopy:"Canopy (Area, Density, Condition)",ecologicalBenefits:"Ecological Benefits (CO₂, Pollutants, Wildlife)",environmentalFactors:"Environmental (Climate, Site, Position)",metadata:"Metadata (Planting Method, Timestamps)"}).map(([t,a])=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:m[t],onChange:()=>N(t),className:"w-4 h-4 text-green-600 rounded focus:ring-green-500"}),e.jsx("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:a})]},t))})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Format"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",style:{borderColor:o==="csv"?"#10b981":"#e5e7eb"},children:[e.jsx("input",{type:"radio",value:"csv",checked:o==="csv",onChange:t=>j(t.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"CSV"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"Comma-separated values, compatible with Excel"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",style:{borderColor:o==="xlsx"?"#10b981":"#e5e7eb"},children:[e.jsx("input",{type:"radio",value:"xlsx",checked:o==="xlsx",onChange:t=>j(t.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"Excel (XLSX)"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"Native Excel format with formatting"})]})]})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 sticky top-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Preview"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Format:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white uppercase",children:o})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Scope:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white capitalize",children:i})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Fields:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[g," selected"]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Exporting:"}),e.jsx("span",{className:"block font-medium text-gray-900 dark:text-white mt-1",children:E})]})]}),e.jsx("button",{onClick:C,disabled:u||g===0,className:`w-full py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center ${u||g===0?"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:u?e.jsxs(e.Fragment,{children:[e.jsx(O,{size:"small",className:"mr-2"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Data"]})}),g===0&&e.jsx("p",{className:"mt-3 text-sm text-red-600 dark:text-red-400",children:"Please select at least one field to export"})]})})]})]})})]})]})};export{_ as ExportPage};
