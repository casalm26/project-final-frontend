import{r as i,c as q}from"./index-eAO8Bxia.js";import{h as V,af as G,j as U,k as Q,s as de,aC as F,aD as Z,aE as X,m as pe,aF as he,n as me,o as ve,y as fe,p as ee,q as ye,aG as xe,aH as ge,t as Ae,w as be,x as Ie,aI as Pe,G as Ee,A as ae,O as L,aJ as te,D as R,F as Ce,aK as H,I as J,J as Y,ao as _,K as De,M as Se,aL as N,aM as ke,a1 as B,$ as Oe,aN as M,aO as we,z as Ne,a2 as Le,a3 as _e,e as Ke}from"./EnhancedStatCard-BQz55mNK.js";import{t as Re}from"./useSidebarState-4rBSpLs5.js";var re=(e,a,t,r)=>U(e,"xAxis",a,r),ne=(e,a,t,r)=>Q(e,"xAxis",a,r),ie=(e,a,t,r)=>U(e,"yAxis",t,r),se=(e,a,t,r)=>Q(e,"yAxis",t,r),je=V([G,re,ie,ne,se],(e,a,t,r,s)=>Z(e,"xAxis")?X(a,r,!1):X(t,s,!1)),Me=(e,a,t,r,s)=>{var n,c=G(e),l=Z(c,"xAxis"),o;if(l?o=F(e,"yAxis",t,r):o=F(e,"xAxis",a,r),o!=null){var{dataKey:u,stackId:h}=s;if(h!=null){var f=(n=o[h])===null||n===void 0?void 0:n.stackedData;return f==null?void 0:f.find(d=>d.key===u)}}},Te=(e,a,t,r,s)=>s,We=V([pe,Te],(e,a)=>{if(e.some(t=>t.type==="area"&&a.dataKey===t.dataKey&&he(a.stackId)===t.stackId&&a.data===t.data))return a}),Be=V([G,re,ie,ne,se,Me,de,je,We],(e,a,t,r,s,n,c,l,o)=>{var{chartData:u,dataStartIndex:h,dataEndIndex:f}=c;if(!(o==null||e!=="horizontal"&&e!=="vertical"||a==null||t==null||r==null||s==null||r.length===0||s.length===0||l==null)){var{data:d}=o,v;if(d&&d.length>0?v=d:v=u==null?void 0:u.slice(h,f+1),v!=null){var y=void 0;return ia({layout:e,xAxis:a,yAxis:t,xAxisTicks:r,yAxisTicks:s,dataStartIndex:h,areaSettings:o,stackedData:n,displayedData:v,chartBaseValue:y,bandSize:l})}}}),ze=["layout","type","stroke","connectNulls","isRange"],Ve=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function le(e,a){if(e==null)return{};var t,r,s=Ge(e,a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)t=n[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}function Ge(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function $(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,r)}return t}function w(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?$(Object(t),!0).forEach(function(r){W(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function W(e,a,t){return(a=Fe(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function Fe(e){var a=Xe(e,"string");return typeof a=="symbol"?a:a+""}function Xe(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function C(){return C=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},C.apply(null,arguments)}function T(e,a){return e&&e!=="none"?e:a}var He=e=>{var{dataKey:a,name:t,stroke:r,fill:s,legendType:n,hide:c}=e;return[{inactive:c,dataKey:a,type:n,color:T(r,s),value:ee(t,a),payload:e}]};function Je(e){var{dataKey:a,data:t,stroke:r,strokeWidth:s,fill:n,name:c,hide:l,unit:o}=e;return{dataDefinedOnItem:t,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:n,dataKey:a,nameKey:void 0,name:ee(c,a),hide:l,type:e.tooltipType,color:T(r,n),unit:o}}}var Ye=(e,a)=>{var t;if(i.isValidElement(e))t=i.cloneElement(e,a);else if(typeof e=="function")t=e(a);else{var r=q("recharts-area-dot",typeof e!="boolean"?e.className:"");t=i.createElement(we,C({},a,{className:r}))}return t};function $e(e,a){return e==null?!1:a?!0:e.length===1}function qe(e){var{clipPathId:a,points:t,props:r}=e,{needClip:s,dot:n,dataKey:c}=r;if(!$e(t,n))return null;var l=te(n),o=L(r,!1),u=L(n,!0),h=t.map((d,v)=>{var y=w(w(w({key:"dot-".concat(v),r:3},o),u),{},{index:v,cx:d.x,cy:d.y,dataKey:c,value:d.value,payload:d.payload,points:t});return Ye(n,y)}),f={clipPath:s?"url(#clipPath-".concat(l?"":"dots-").concat(a,")"):void 0};return i.createElement(R,C({className:"recharts-area-dots"},f),h)}function z(e){var{points:a,baseLine:t,needClip:r,clipPathId:s,props:n,showLabels:c}=e,{layout:l,type:o,stroke:u,connectNulls:h,isRange:f}=n,d=le(n,ze);return i.createElement(i.Fragment,null,(a==null?void 0:a.length)>1&&i.createElement(R,{clipPath:r?"url(#clipPath-".concat(s,")"):void 0},i.createElement(B,C({},L(d,!0),{points:a,connectNulls:h,type:o,baseLine:t,layout:l,stroke:"none",className:"recharts-area-area"})),u!=="none"&&i.createElement(B,C({},L(n,!1),{className:"recharts-area-curve",layout:l,type:o,connectNulls:h,fill:"none",points:a})),u!=="none"&&f&&i.createElement(B,C({},L(n,!1),{className:"recharts-area-curve",layout:l,type:o,connectNulls:h,fill:"none",points:t}))),i.createElement(qe,{points:a,props:n,clipPathId:s}),c&&Oe.renderCallByParent(n,a))}function Ue(e){var{alpha:a,baseLine:t,points:r,strokeWidth:s}=e,n=r[0].y,c=r[r.length-1].y;if(!M(n)||!M(c))return null;var l=a*Math.abs(n-c),o=Math.max(...r.map(u=>u.x||0));return _(t)?o=Math.max(t,o):t&&Array.isArray(t)&&t.length&&(o=Math.max(...t.map(u=>u.x||0),o)),_(o)?i.createElement("rect",{x:0,y:n<c?n:n-l,width:o+(s?parseInt("".concat(s),10):1),height:Math.floor(l)}):null}function Qe(e){var{alpha:a,baseLine:t,points:r,strokeWidth:s}=e,n=r[0].x,c=r[r.length-1].x;if(!M(n)||!M(c))return null;var l=a*Math.abs(n-c),o=Math.max(...r.map(u=>u.y||0));return _(t)?o=Math.max(t,o):t&&Array.isArray(t)&&t.length&&(o=Math.max(...t.map(u=>u.y||0),o)),_(o)?i.createElement("rect",{x:n<c?n:n-l,y:0,width:l,height:Math.floor(o+(s?parseInt("".concat(s),10):1))}):null}function Ze(e){var{alpha:a,layout:t,points:r,baseLine:s,strokeWidth:n}=e;return t==="vertical"?i.createElement(Ue,{alpha:a,points:r,baseLine:s,strokeWidth:n}):i.createElement(Qe,{alpha:a,points:r,baseLine:s,strokeWidth:n})}function ea(e){var{needClip:a,clipPathId:t,props:r,previousPointsRef:s,previousBaselineRef:n}=e,{points:c,baseLine:l,isAnimationActive:o,animationBegin:u,animationDuration:h,animationEasing:f,onAnimationStart:d,onAnimationEnd:v}=r,y=De(r,"recharts-area-"),[x,g]=i.useState(!0),E=i.useCallback(()=>{typeof v=="function"&&v(),g(!1)},[v]),P=i.useCallback(()=>{typeof d=="function"&&d(),g(!0)},[d]),A=s.current,p=n.current;return i.createElement(Se,{begin:u,duration:h,isActive:o,easing:f,from:{t:0},to:{t:1},onAnimationEnd:E,onAnimationStart:P,key:y},b=>{var{t:m}=b;if(A){var D=A.length/c.length,j=m===1?c:c.map((I,K)=>{var k=Math.floor(K*D);if(A[k]){var O=A[k];return w(w({},I),{},{x:N(O.x,I.x,m),y:N(O.y,I.y,m)})}return I}),S;return _(l)?S=N(p,l,m):ae(l)||ke(l)?S=N(p,0,m):S=l.map((I,K)=>{var k=Math.floor(K*D);if(Array.isArray(p)&&p[k]){var O=p[k];return w(w({},I),{},{x:N(O.x,I.x,m),y:N(O.y,I.y,m)})}return I}),m>0&&(s.current=j,n.current=S),i.createElement(z,{points:j,baseLine:S,needClip:a,clipPathId:t,props:r,showLabels:!x})}return m>0&&(s.current=c,n.current=l),i.createElement(R,null,i.createElement("defs",null,i.createElement("clipPath",{id:"animationClipPath-".concat(t)},i.createElement(Ze,{alpha:m,points:c,baseLine:l,layout:r.layout,strokeWidth:r.strokeWidth}))),i.createElement(R,{clipPath:"url(#animationClipPath-".concat(t,")")},i.createElement(z,{points:c,baseLine:l,needClip:a,clipPathId:t,props:r,showLabels:!0})))})}function aa(e){var{needClip:a,clipPathId:t,props:r}=e,{points:s,baseLine:n,isAnimationActive:c}=r,l=i.useRef(null),o=i.useRef(),u=l.current,h=o.current;return c&&s&&s.length&&(u!==s||h!==n)?i.createElement(ea,{needClip:a,clipPathId:t,props:r,previousPointsRef:l,previousBaselineRef:o}):i.createElement(z,{points:s,baseLine:n,needClip:a,clipPathId:t,props:r,showLabels:!0})}class ta extends i.PureComponent{constructor(){super(...arguments),W(this,"id",Ne("recharts-area-"))}render(){var a,{hide:t,dot:r,points:s,className:n,top:c,left:l,needClip:o,xAxisId:u,yAxisId:h,width:f,height:d,id:v,baseLine:y}=this.props;if(t)return null;var x=q("recharts-area",n),g=ae(v)?this.id:v,{r:E=3,strokeWidth:P=2}=(a=L(r,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},A=te(r),p=E*2+P;return i.createElement(i.Fragment,null,i.createElement(R,{className:x},o&&i.createElement("defs",null,i.createElement(Ce,{clipPathId:g,xAxisId:u,yAxisId:h}),!A&&i.createElement("clipPath",{id:"clipPath-dots-".concat(g)},i.createElement("rect",{x:l-p/2,y:c-p/2,width:f+p,height:d+p}))),i.createElement(aa,{needClip:o,clipPathId:g,props:this.props})),i.createElement(H,{points:s,mainColor:T(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(y)&&i.createElement(H,{points:y,mainColor:T(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var oe={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Ee.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function ra(e){var a,t=ye(e,oe),{activeDot:r,animationBegin:s,animationDuration:n,animationEasing:c,connectNulls:l,dot:o,fill:u,fillOpacity:h,hide:f,isAnimationActive:d,legendType:v,stroke:y,xAxisId:x,yAxisId:g}=t,E=le(t,Ve),P=xe(),A=ge(),{needClip:p}=Ae(x,g),b=be(),m=i.useMemo(()=>({baseValue:e.baseValue,stackId:e.stackId,connectNulls:l,data:e.data,dataKey:e.dataKey}),[e.baseValue,e.stackId,l,e.data,e.dataKey]),{points:D,isRange:j,baseLine:S}=(a=Ie(ue=>Be(ue,x,g,b,m)))!==null&&a!==void 0?a:{},{height:I,width:K,x:k,y:O}=Pe();return P!=="horizontal"&&P!=="vertical"||A!=="AreaChart"&&A!=="ComposedChart"?null:i.createElement(ta,C({},E,{activeDot:r,animationBegin:s,animationDuration:n,animationEasing:c,baseLine:S,connectNulls:l,dot:o,fill:u,fillOpacity:h,height:I,hide:f,layout:P,isAnimationActive:d,isRange:j,legendType:v,needClip:p,points:D,stroke:y,width:K,left:k,top:O,xAxisId:x,yAxisId:g}))}var na=(e,a,t,r,s)=>{var n=t??a;if(_(n))return n;var c=e==="horizontal"?s:r,l=c.scale.domain();if(c.type==="number"){var o=Math.max(l[0],l[1]),u=Math.min(l[0],l[1]);return n==="dataMin"?u:n==="dataMax"||o<0?o:Math.max(Math.min(l[0],l[1]),0)}return n==="dataMin"?l[0]:n==="dataMax"?l[1]:l[0]};function ia(e){var{areaSettings:{connectNulls:a,baseValue:t,dataKey:r},stackedData:s,layout:n,chartBaseValue:c,xAxis:l,yAxis:o,displayedData:u,dataStartIndex:h,xAxisTicks:f,yAxisTicks:d,bandSize:v}=e,y=s&&s.length,x=na(n,c,t,l,o),g=n==="horizontal",E=!1,P=u.map((p,b)=>{var m;y?m=s[h+b]:(m=J(p,r),Array.isArray(m)?E=!0:m=[x,m]);var D=m[1]==null||y&&!a&&J(p,r)==null;return g?{x:Y({axis:l,ticks:f,bandSize:v,entry:p,index:b}),y:D?null:o.scale(m[1]),value:m,payload:p}:{x:D?null:l.scale(m[1]),y:Y({axis:o,ticks:d,bandSize:v,entry:p,index:b}),value:m,payload:p}}),A;return y||E?A=P.map(p=>{var b=Array.isArray(p.value)?p.value[0]:null;return g?{x:p.x,y:b!=null&&p.y!=null?o.scale(b):null}:{x:b!=null?l.scale(b):null,y:p.y}}):A=g?o.scale(x):l.scale(x),{points:P,baseLine:A,isRange:E}}class ce extends i.PureComponent{render(){return i.createElement(me,{type:"area",data:this.props.data,dataKey:this.props.dataKey,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,stackId:this.props.stackId,hide:this.props.hide,barSize:void 0},i.createElement(ve,{legendPayload:He(this.props)}),i.createElement(fe,{fn:Je,args:this.props}),i.createElement(ra,this.props))}}W(ce,"displayName","Area");W(ce,"defaultProps",oe);var sa=["axis"],ma=i.forwardRef((e,a)=>i.createElement(Le,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:sa,tooltipPayloadSearcher:_e,categoricalChartProps:e,ref:a}));const la=10*60*1e3,oa=e=>{const a=JSON.stringify(e);return`dashboard_stats_${btoa(a)}`},ca=e=>{try{const a=sessionStorage.getItem(e);if(!a)return null;const{data:t,timestamp:r}=JSON.parse(a);return Date.now()-r>la?(sessionStorage.removeItem(e),null):t}catch(a){return console.warn("Dashboard cache read error:",a),null}},ua=(e,a)=>{try{const t={data:a,timestamp:Date.now()};sessionStorage.setItem(e,JSON.stringify(t))}catch(t){console.warn("Dashboard cache write error:",t)}},va=(e={})=>{var h,f;const[a,t]=i.useState(null),[r,s]=i.useState(!0),[n,c]=i.useState(null),l=i.useMemo(()=>Re(e),[(h=e==null?void 0:e.dateRange)==null?void 0:h.startDate,(f=e==null?void 0:e.dateRange)==null?void 0:f.endDate,e==null?void 0:e.selectedForests,e==null?void 0:e.species]),o=i.useCallback(async()=>{try{s(!0),c(null);const d=oa(l),v=ca(d);if(v){t(v),s(!1);return}const x=(await Ke.getEnhancedStats(l)).data;ua(d,x),t(x)}catch(d){console.error("Error fetching dashboard stats:",d),c(d.message||"Failed to fetch dashboard statistics")}finally{s(!1)}},[l]);i.useEffect(()=>{o()},[o]);const u=i.useCallback(()=>{o()},[o]);return{stats:a,loading:r,error:n,refresh:u}};export{ma as A,ce as a,va as u};
