import{r as l,c as Me,j as e,b as ie,L as ne}from"./index-tEqMizXb.js";import{C as I,a as C,b as E}from"./ChartComponents-BKyCVLLP.js";import{i as B,u as Oe,f as Te,r as De,S as ue,g as Ke,h as ve,s as Le,j as be,k as je,l as _e,m as Re,n as ze,o as Be,p as ke,q as Fe,t as He,v as Ve,w as $e,x as we,y as We,G as Ge,C as se,z as Ze,A as V,D as J,F as Ye,H as Ue,I as re,J as pe,K as Je,M as Qe,N as te,O as oe,P as Xe,Q as qe,U as et,V as tt,W as at,Z as rt,_ as st,$ as it,a0 as nt,a1 as ot,a2 as lt,a3 as ct,R as $,T as W,a as Q,X,Y as q,B as le,e as de,b as ce,d as H,L as dt,E as ae}from"./EnhancedStatCard-CVgqadrW.js";import{P as ht,a as mt,B as Ne}from"./PieChart-DRbmPJpB.js";import{A as xt,a as ge,u as ut}from"./useDashboardStats-3Mt6zhuV.js";import{G as pt}from"./GlobalFilters-B5C4gkva.js";import{u as gt,D as ft,a as yt}from"./useSidebarState-CJJaSDFr.js";import"./vendor-BtP0CW_r.js";import"./DarkModeToggle-ZfYhBz0e.js";import"./IconButton-DmJ5sToe.js";function Se(t,r,a){return(r=vt(r))in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function vt(t){var r=bt(t,"string");return typeof r=="symbol"?r:r+""}function bt(t,r){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var s=a.call(t,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function jt(t){var r=Oe();return l.useEffect(()=>(r(Te(t)),()=>{r(De(t))}),[t,r]),null}class he extends l.Component{render(){return l.createElement(jt,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:B.allowDuplicatedCategory,allowDataOverflow:B.allowDataOverflow,reversed:B.reversed,includeHidden:B.includeHidden})}}Se(he,"displayName","ZAxis");Se(he,"defaultProps",{zAxisId:0,range:B.range,scale:B.scale,type:B.type});var kt=["option","isActive"];function U(){return U=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var s in a)({}).hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},U.apply(null,arguments)}function wt(t,r){if(t==null)return{};var a,s,c=Nt(t,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)a=i[s],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(c[a]=t[a])}return c}function Nt(t,r){if(t==null)return{};var a={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(r.indexOf(s)!==-1)continue;a[s]=t[s]}return a}function St(t){var{option:r,isActive:a}=t,s=wt(t,kt);return typeof r=="string"?l.createElement(ue,U({option:l.createElement(Ke,U({type:r},s)),isActive:a,shapeType:"symbols"},s)):l.createElement(ue,U({option:r,isActive:a,shapeType:"symbols"},s))}var At=(t,r,a,s,c,i,m)=>be(t,"xAxis",r,m),Pt=(t,r,a,s,c,i,m)=>je(t,"xAxis",r,m),It=(t,r,a,s,c,i,m)=>be(t,"yAxis",a,m),Ct=(t,r,a,s,c,i,m)=>je(t,"yAxis",a,m),Et=(t,r,a,s)=>_e(t,"zAxis",s,!1),Mt=(t,r,a,s,c)=>c,Ot=(t,r,a,s,c,i)=>i,Tt=(t,r,a,s,c,i,m)=>Le(t,r,a,m),Dt=ve([Re,Mt],(t,r)=>{if(t.some(a=>a.type==="scatter"&&r.dataKey===a.dataKey&&r.data===a.data))return r}),Kt=ve([Tt,At,Pt,It,Ct,Et,Dt,Ot],(t,r,a,s,c,i,m,y)=>{var{chartData:u,dataStartIndex:g,dataEndIndex:j}=t;if(m!=null){var p;if((m==null?void 0:m.data)!=null&&m.data.length>0?p=m.data:p=u==null?void 0:u.slice(g,j+1),!(p==null||r==null||s==null||a==null||c==null||(a==null?void 0:a.length)===0||(c==null?void 0:c.length)===0))return Gt({displayedData:p,xAxis:r,yAxis:s,zAxis:i,scatterSettings:m,xAxisTicks:a,yAxisTicks:c,cells:y})}}),Lt=["onMouseEnter","onClick","onMouseLeave"],_t=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function Ae(t,r){if(t==null)return{};var a,s,c=Rt(t,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)a=i[s],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(c[a]=t[a])}return c}function Rt(t,r){if(t==null)return{};var a={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(r.indexOf(s)!==-1)continue;a[s]=t[s]}return a}function G(){return G=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var s in a)({}).hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},G.apply(null,arguments)}function fe(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),a.push.apply(a,s)}return a}function M(t){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?fe(Object(a),!0).forEach(function(s){me(t,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):fe(Object(a)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(a,s))})}return t}function me(t,r,a){return(r=zt(r))in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function zt(t){var r=Bt(t,"string");return typeof r=="symbol"?r:r+""}function Bt(t,r){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var s=a.call(t,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Ft=t=>{var{dataKey:r,name:a,fill:s,legendType:c,hide:i}=t;return[{inactive:i,dataKey:r,type:c,color:s,value:ke(a,r),payload:t}]};function Ht(t){var{points:r,props:a}=t,{line:s,lineType:c,lineJointType:i}=a;if(!s)return null;var m=oe(a,!1),y=oe(s,!1),u,g;if(c==="joint")u=r.map(o=>({x:o.cx,y:o.cy}));else if(c==="fitting"){var{xmin:j,xmax:p,a:v,b:x}=nt(r),n=o=>v*o+x;u=[{x:j,y:n(j)},{x:p,y:n(p)}]}var d=M(M(M({},m),{},{fill:"none",stroke:m&&m.fill},y),{},{points:u});return l.isValidElement(s)?g=l.cloneElement(s,d):typeof s=="function"?g=s(d):g=l.createElement(ot,G({},d,{type:i})),l.createElement(J,{className:"recharts-scatter-line",key:"recharts-scatter-line"},g)}function Pe(t){var{points:r,showLabels:a,allOtherScatterProps:s}=t,{shape:c,activeShape:i,dataKey:m}=s,y=oe(s,!1),u=we(Xe),{onMouseEnter:g,onClick:j,onMouseLeave:p}=s,v=Ae(s,Lt),x=qe(g,s.dataKey),n=et(p),d=tt(j,s.dataKey);return r==null?null:l.createElement(l.Fragment,null,l.createElement(Ht,{points:r,props:s}),r.map((o,h)=>{var f=i&&u===String(h),b=f?i:c,k=M(M(M({key:"symbol-".concat(h)},y),o),{},{[rt]:h,[at]:String(m)});return l.createElement(J,G({className:"recharts-scatter-symbol"},st(v,o,h),{onMouseEnter:x(o,h),onMouseLeave:n(o,h),onClick:d(o,h),key:"symbol-".concat(o==null?void 0:o.cx,"-").concat(o==null?void 0:o.cy,"-").concat(o==null?void 0:o.size,"-").concat(h)}),l.createElement(St,G({option:b,isActive:f},k)))}),a&&it.renderCallByParent(s,r))}function Vt(t){var{previousPointsRef:r,props:a}=t,{points:s,isAnimationActive:c,animationBegin:i,animationDuration:m,animationEasing:y}=a,u=r.current,g=Je(a,"recharts-scatter-"),[j,p]=l.useState(!1),v=l.useCallback(()=>{p(!1)},[]),x=l.useCallback(()=>{p(!0)},[]);return l.createElement(Qe,{begin:i,duration:m,isActive:c,easing:y,from:{t:0},to:{t:1},onAnimationEnd:v,onAnimationStart:x,key:g},n=>{var{t:d}=n,o=d===1?s:s.map((h,f)=>{var b=u&&u[f];if(b){var k=te(b.cx,h.cx),S=te(b.cy,h.cy),w=te(b.size,h.size);return M(M({},h),{},{cx:k(d),cy:S(d),size:w(d)})}var A=te(0,h.size);return M(M({},h),{},{size:A(d)})});return d>0&&(r.current=o),l.createElement(J,null,l.createElement(Pe,{points:o,allOtherScatterProps:a,showLabels:!j}))})}function $t(t){var{points:r,isAnimationActive:a}=t,s=l.useRef(null),c=s.current;return a&&r&&r.length&&(!c||c!==r)?l.createElement(Vt,{props:t,previousPointsRef:s}):l.createElement(Pe,{points:r,allOtherScatterProps:t,showLabels:!0})}function Wt(t){var{dataKey:r,points:a,stroke:s,strokeWidth:c,fill:i,name:m,hide:y,tooltipType:u}=t;return{dataDefinedOnItem:a==null?void 0:a.map(g=>g.tooltipPayload),positions:a==null?void 0:a.map(g=>g.tooltipPosition),settings:{stroke:s,strokeWidth:c,fill:i,nameKey:void 0,dataKey:r,name:ke(m,r),hide:y,type:u,color:i,unit:""}}}function Gt(t){var{displayedData:r,xAxis:a,yAxis:s,zAxis:c,scatterSettings:i,xAxisTicks:m,yAxisTicks:y,cells:u}=t,g=V(a.dataKey)?i.dataKey:a.dataKey,j=V(s.dataKey)?i.dataKey:s.dataKey,p=c&&c.dataKey,v=c?c.range:he.defaultProps.range,x=v&&v[0],n=a.scale.bandwidth?a.scale.bandwidth():0,d=s.scale.bandwidth?s.scale.bandwidth():0;return r.map((o,h)=>{var f=re(o,g),b=re(o,j),k=!V(p)&&re(o,p)||"-",S=[{name:V(a.dataKey)?i.name:a.name||a.dataKey,unit:a.unit||"",value:f,payload:o,dataKey:g,type:i.tooltipType},{name:V(s.dataKey)?i.name:s.name||s.dataKey,unit:s.unit||"",value:b,payload:o,dataKey:j,type:i.tooltipType}];k!=="-"&&S.push({name:c.name||c.dataKey,unit:c.unit||"",value:k,payload:o,dataKey:p,type:i.tooltipType});var w=pe({axis:a,ticks:m,bandSize:n,entry:o,index:h,dataKey:g}),A=pe({axis:s,ticks:y,bandSize:d,entry:o,index:h,dataKey:j}),D=k!=="-"?c.scale(k):x,P=Math.sqrt(Math.max(D,0)/Math.PI);return M(M({},o),{},{cx:w,cy:A,x:w-P,y:A-P,width:2*P,height:2*P,size:D,node:{x:f,y:b,z:k},tooltipPayload:S,tooltipPosition:{x:w,y:A},payload:o},u&&u[h]&&u[h].props)})}var Zt=(t,r,a)=>({x:t.cx,y:t.cy,value:a==="x"?+t.node.x:+t.node.y,errorVal:re(t,r)});function Yt(t){var r=l.useRef(Ze("recharts-scatter-")),{hide:a,points:s,className:c,needClip:i,xAxisId:m,yAxisId:y,id:u,children:g}=t;if(a)return null;var j=Me("recharts-scatter",c),p=V(u)?r.current:u;return l.createElement(J,{className:j,clipPath:i?"url(#clipPath-".concat(p,")"):null},i&&l.createElement("defs",null,l.createElement(Ye,{clipPathId:p,xAxisId:m,yAxisId:y})),l.createElement(Ue,{xAxisId:m,yAxisId:y,data:s,dataPointFormatter:Zt,errorBarOffset:0},g),l.createElement(J,{key:"recharts-scatter-symbols"},l.createElement($t,t)))}var Ie={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Ge.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function Ut(t){var r=Fe(t,Ie),{animationBegin:a,animationDuration:s,animationEasing:c,hide:i,isAnimationActive:m,legendType:y,lineJointType:u,lineType:g,shape:j,xAxisId:p,yAxisId:v,zAxisId:x}=r,n=Ae(r,_t),{needClip:d}=He(p,v),o=l.useMemo(()=>Ve(t.children,se),[t.children]),h=l.useMemo(()=>({name:t.name,tooltipType:t.tooltipType,data:t.data,dataKey:t.dataKey}),[t.data,t.dataKey,t.name,t.tooltipType]),f=$e(),b=we(k=>Kt(k,p,v,x,h,o,f));return d==null?null:l.createElement(l.Fragment,null,l.createElement(We,{fn:Wt,args:M(M({},t),{},{points:b})}),l.createElement(Yt,G({},n,{xAxisId:p,yAxisId:v,zAxisId:x,lineType:g,lineJointType:u,legendType:y,shape:j,hide:i,isAnimationActive:m,animationBegin:a,animationDuration:s,animationEasing:c,points:b,needClip:d})))}class xe extends l.Component{render(){return l.createElement(ze,{type:"scatter",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:this.props.zAxisId,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},l.createElement(Be,{legendPayload:Ft(this.props)}),l.createElement(Ut,this.props))}}me(xe,"displayName","Scatter");me(xe,"defaultProps",Ie);var Jt=["item"],Qt=l.forwardRef((t,r)=>l.createElement(lt,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Jt,tooltipPayloadSearcher:ct,categoricalChartProps:t,ref:r}));const Xt=({filters:t={},chartType:r="bar"})=>{const[a,s]=l.useState([]),[c,i]=l.useState(!0),[m,y]=l.useState(null),u=l.useMemo(()=>({excellent:"#10b981",good:"#3b82f6",fair:"#f59e0b",poor:"#ef4444",critical:"#dc2626"}),[]);l.useEffect(()=>{(async()=>{var d,o;try{i(!0),y(null);const b=(((o=(d=(await de.getStats(t)).data)==null?void 0:d.distributions)==null?void 0:o.health)||[]).map(S=>{var w;return{status:S._id||"Unknown",count:S.count||0,fill:u[(w=S._id)==null?void 0:w.toLowerCase()]||"#6b7280"}}),k=["excellent","good","fair","poor","critical"];b.sort((S,w)=>{const A=k.indexOf(S.status.toLowerCase()),D=k.indexOf(w.status.toLowerCase());return A-D}),s(b)}catch(h){console.error("Error fetching health distribution data:",h),y(h.message||"Failed to load health distribution data")}finally{i(!1)}})()},[t,u]);const g=n=>n.charAt(0).toUpperCase()+n.slice(1),j=({active:n,payload:d,label:o})=>{if(n&&d&&d.length){const h=d[0];return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:`${g(o||h.payload.status)}: ${h.value} trees`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:`${(h.value/h.payload.total*100).toFixed(1)}%`})]})}return null},p=({active:n,payload:d})=>{var o;if(n&&d&&d.length){const h=d[0],f=h.payload.totalTrees||((o=h.payload.data)==null?void 0:o.reduce((b,k)=>b+k.count,0))||0;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:`${g(h.payload.status)}: ${h.value} trees`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f>0?`${(h.value/f*100).toFixed(1)}%`:"0%"})]})}return null};if(c)return e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Tree Health Status Distribution"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsx(ie,{size:"32px",text:"Loading health data..."})})]});if(m)return e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Tree Health Status Distribution"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Error loading chart data"}),e.jsx("p",{className:"text-sm text-gray-500",children:m})]})})]});if(!a||a.length===0)return e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Tree Health Status Distribution"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsx("p",{className:"text-gray-500",children:"No health status data available"})})]});const v=a.reduce((n,d)=>n+d.count,0),x=a.map(n=>({...n,total:v}));return r==="pie"?e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Tree Health Status Distribution"})}),e.jsx($,{width:"100%",height:300,children:e.jsxs(ht,{children:[e.jsx(mt,{data:x,cx:"50%",cy:"50%",labelLine:!1,label:({status:n,percent:d})=>`${g(n)}: ${(d*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:x.map((n,d)=>e.jsx(se,{fill:n.fill},`cell-${d}`))}),e.jsx(W,{content:e.jsx(p,{})})]})})]}):e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Tree Health Status Distribution"})}),e.jsx($,{width:"100%",height:300,children:e.jsxs(Ne,{data:x,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Q,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(X,{dataKey:"status",className:"text-xs",tick:{fontSize:12},tickFormatter:g}),e.jsx(q,{className:"text-xs",tick:{fontSize:12}}),e.jsx(W,{content:e.jsx(j,{})}),e.jsx(le,{dataKey:"count",radius:[4,4,0,0],children:x.map((n,d)=>e.jsx(se,{fill:n.fill},`cell-${d}`))})]})}),e.jsx("div",{className:"flex flex-wrap justify-center mt-4 gap-4",children:x.map((n,d)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded mr-2",style:{backgroundColor:n.fill}}),e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[g(n.status)," (",n.count,")"]})]},d))})]})},qt=({filters:t={},chartType:r="bar"})=>{const[a,s]=l.useState([]),[c,i]=l.useState(!0),[m,y]=l.useState(null);l.useEffect(()=>{(async()=>{var n,d;try{i(!0),y(null);const h=(await de.getStats(t)).data,f=(n=h==null?void 0:h.investor)==null?void 0:n.timber,b=(d=h==null?void 0:h.investor)==null?void 0:d.carbonCredits,S=["Pine","Oak","Birch","Spruce","Maple","Beech","Fir","Cedar","Willow","Ash"].map((w,A)=>{const D=((f==null?void 0:f.averageValuePerTree)||5e3)*(.8+Math.random()*.4),P=((b==null?void 0:b.averagePrice)||500)*(10+Math.random()*20),K={Pine:{timber:1,carbon:.9,growth:1.2},Oak:{timber:1.4,carbon:1.3,growth:.8},Birch:{timber:.8,carbon:1,growth:1.5},Spruce:{timber:1.1,carbon:1.1,growth:1},Maple:{timber:1.3,carbon:1.2,growth:.9},Beech:{timber:1.2,carbon:1.1,growth:.85},Fir:{timber:1,carbon:1,growth:1},Cedar:{timber:1.5,carbon:1.4,growth:.7},Willow:{timber:.6,carbon:.8,growth:1.8},Ash:{timber:1.25,carbon:1.15,growth:.95}}[w]||{timber:1,carbon:1,growth:1},L=Math.round(D*K.timber),_=Math.round(P*K.carbon),O=L+_,R=Math.round((O/3e3-1)*100),F=Math.round(K.growth*100)/10;return{species:w,timberValue:L,carbonValue:_,totalValue:O,roi:R,growthRate:F,riskLevel:{Pine:2,Oak:1,Birch:3,Spruce:2,Maple:1,Beech:1,Fir:2,Cedar:1,Willow:4,Ash:2}[w]||2,treeCount:Math.floor(Math.random()*500)+100,averageAge:Math.floor(Math.random()*30)+10,timberValuePerYear:Math.round(L/25),carbonValuePerYear:Math.round(_/10),totalROI:R}}).sort((w,A)=>A.totalValue-w.totalValue);s(S)}catch(o){console.error("Error fetching species performance data:",o),y(o.message||"Failed to load species data")}finally{i(!1)}})()},[t,r]);const u=x=>x?new Intl.NumberFormat("sv-SE",{style:"currency",currency:"SEK",minimumFractionDigits:0,maximumFractionDigits:0}).format(x):"0 SEK",g=x=>`${x}%`,j=x=>x>=15?"#10b981":x>=5?"#f59e0b":"#ef4444",p=({active:x,payload:n,label:d})=>{if(x&&n&&n.length){const o=n[0].payload;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:d}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:["Total Value: ",u(o.totalValue)]}),e.jsxs("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Timber Value: ",u(o.timberValue)]}),e.jsxs("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:["Carbon Value: ",u(o.carbonValue)]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["ROI: ",g(o.roi)]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Growth Rate: ",o.growthRate,"%/year"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Trees: ",o.treeCount.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Risk Level: ",o.riskLevel,"/5"]})]})]})}return null},v=({active:x,payload:n,label:d})=>{if(x&&n&&n.length){const o=n[0].payload;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:o.species}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["ROI: ",g(o.roi)]}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:["Growth Rate: ",o.growthRate,"%/year"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Total Value: ",u(o.totalValue)]})]})]})}return null};return c?e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Species Economic Performance"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsx(ie,{size:"32px",text:"Loading species data..."})})]}):m?e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Species Economic Performance"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Error loading chart data"}),e.jsx("p",{className:"text-sm text-gray-500",children:m})]})})]}):!a||a.length===0?e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Species Economic Performance"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsx("p",{className:"text-gray-500",children:"No species data available"})})]}):r==="scatter"?e.jsxs(I,{children:[e.jsxs(C,{children:[e.jsx(E,{children:"ROI vs Growth Rate by Species"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Investment return vs growth performance analysis"})]}),e.jsx($,{width:"100%",height:300,children:e.jsxs(Qt,{margin:{top:20,right:20,bottom:20,left:20},children:[e.jsx(Q,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(X,{type:"number",dataKey:"growthRate",name:"Growth Rate",className:"text-xs",tick:{fontSize:12},label:{value:"Growth Rate (%/year)",position:"insideBottom",offset:-10}}),e.jsx(q,{type:"number",dataKey:"roi",name:"ROI",className:"text-xs",tick:{fontSize:12},label:{value:"ROI (%)",angle:-90,position:"insideLeft"}}),e.jsx(W,{content:e.jsx(v,{})}),e.jsx(xe,{name:"Species",data:a,fill:"#3b82f6",children:a.map((x,n)=>e.jsx(se,{fill:j(x.roi)},`cell-${n}`))})]})})]}):e.jsxs(I,{children:[e.jsxs(C,{children:[e.jsx(E,{children:"Species Economic Performance"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Timber and carbon value potential by tree species"})]}),e.jsx($,{width:"100%",height:300,children:e.jsxs(Ne,{data:a,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Q,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(X,{dataKey:"species",className:"text-xs",tick:{fontSize:11},angle:-45,textAnchor:"end",height:60}),e.jsx(q,{className:"text-xs",tick:{fontSize:12},tickFormatter:x=>`${(x/1e3).toFixed(0)}k`}),e.jsx(W,{content:e.jsx(p,{})}),e.jsx(ce,{}),e.jsx(le,{dataKey:"timberValue",stackId:"value",fill:"#8b5cf6",name:"Timber Value (SEK)",radius:[0,0,0,0]}),e.jsx(le,{dataKey:"carbonValue",stackId:"value",fill:"#10b981",name:"Carbon Value (SEK)",radius:[4,4,0,0]})]})})]})},ye=({filters:t={},chartType:r="line"})=>{const[a,s]=l.useState([]),[c,i]=l.useState(!0),[m,y]=l.useState(null);l.useEffect(()=>{(async()=>{try{i(!0),y(null);const x=(await de.getStats(t)).data,n=x==null?void 0:x.height,d=(n==null?void 0:n.average)||15,o=new Date().getFullYear(),h=[];for(let f=-5;f<=5;f++){const b=o+f,k=f<=0,S=f===0,w=.8,A=.6,D=.4;let P=null,T=null;if(k||S){const N=d+f*A,z=Math.sin(f*Math.PI/3)*.2,Ce=(Math.random()-.5)*.4;P=Math.max(0,N+z+Ce);const Ee=(Math.random()-.5)*.3;T=N+Ee}else T=d+f*A;const K=Math.abs(f)*.1,L=T+K,_=Math.max(0,T-K),O={temperature:18+Math.sin(f*.5)*2,rainfall:800+Math.cos(f*.3)*100,soilQuality:7.5+(Math.random()-.5)*.5,co2Level:420+f*2},R=Math.max(0,1-Math.abs(O.temperature-18)*.05),F=Math.max(0,1-Math.abs(O.rainfall-800)*.001),Z=Math.max(0,O.soilQuality/10),Y=(R+F+Z)/3,ee=A*Y;h.push({year:b,yearLabel:b.toString(),actualHeight:P?Math.round(P*10)/10:null,predictedHeight:Math.round(T*10)/10,upperBound:Math.round(L*10)/10,lowerBound:Math.round(_*10)/10,growthRate:Math.round(ee*100)/100,isHistorical:k,isFuture:f>0,isCurrent:S,environmentalScore:Math.round(Y*100),temperature:Math.round(O.temperature*10)/10,rainfall:Math.round(O.rainfall),soilQuality:Math.round(O.soilQuality*10)/10,accuracy:P&&T?Math.round((1-Math.abs(P-T)/P)*100):null})}s(h)}catch(v){console.error("Error fetching growth prediction data:",v),y(v.message||"Failed to load growth data")}finally{i(!1)}})()},[t,r]);const u=p=>p?`${p}m`:"0m",g=p=>p?`${p}m/yr`:"0m/yr",j=({active:p,payload:v,label:x})=>{if(p&&v&&v.length){const n=v[0].payload;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:x}),e.jsxs("div",{className:"space-y-1",children:[n.actualHeight&&e.jsxs("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Actual Height: ",u(n.actualHeight)]}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:["Predicted Height: ",u(n.predictedHeight)]}),n.upperBound&&n.lowerBound&&e.jsxs("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:["Range: ",u(n.lowerBound)," - ",u(n.upperBound)]}),e.jsxs("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:["Growth Rate: ",g(n.growthRate)]}),n.accuracy&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Prediction Accuracy: ",n.accuracy,"%"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Environmental Score: ",n.environmentalScore,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 border-t pt-1 mt-1",children:[e.jsxs("p",{children:["Temp: ",n.temperature,"°C | Rainfall: ",n.rainfall,"mm"]}),e.jsxs("p",{children:["Soil pH: ",n.soilQuality]})]})]})]})}return null};return c?e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Growth Performance vs Predictions"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsx(ie,{size:"32px",text:"Loading growth data..."})})]}):m?e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Growth Performance vs Predictions"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Error loading chart data"}),e.jsx("p",{className:"text-sm text-gray-500",children:m})]})})]}):!a||a.length===0?e.jsxs(I,{children:[e.jsx(C,{children:e.jsx(E,{children:"Growth Performance vs Predictions"})}),e.jsx("div",{className:"flex justify-center items-center h-72",children:e.jsx("p",{className:"text-gray-500",children:"No growth data available"})})]}):r==="area"?e.jsxs(I,{children:[e.jsxs(C,{children:[e.jsx(E,{children:"Growth Prediction Confidence Range"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Predicted height range with confidence intervals"})]}),e.jsx($,{width:"100%",height:300,children:e.jsxs(xt,{data:a,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Q,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(X,{dataKey:"yearLabel",className:"text-xs",tick:{fontSize:12}}),e.jsx(q,{className:"text-xs",tick:{fontSize:12},tickFormatter:u}),e.jsx(W,{content:e.jsx(j,{})}),e.jsx(ce,{}),e.jsx(ge,{dataKey:"upperBound",stackId:"1",stroke:"#e5e7eb",fill:"#f3f4f6",name:"Upper Confidence",fillOpacity:.3}),e.jsx(ge,{dataKey:"lowerBound",stackId:"2",stroke:"#e5e7eb",fill:"#ffffff",name:"Lower Confidence",fillOpacity:.3}),e.jsx(H,{type:"monotone",dataKey:"predictedHeight",stroke:"#10b981",strokeWidth:2,name:"Predicted Height",dot:{r:3,fill:"#10b981"},strokeDasharray:"0"}),e.jsx(H,{type:"monotone",dataKey:"actualHeight",stroke:"#3b82f6",strokeWidth:3,name:"Actual Height",dot:{r:4,fill:"#3b82f6"},connectNulls:!1})]})})]}):e.jsxs(I,{children:[e.jsxs(C,{children:[e.jsx(E,{children:"Growth Performance vs Predictions"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Historical actual vs predicted growth with future forecasts"})]}),e.jsx($,{width:"100%",height:300,children:e.jsxs(dt,{data:a,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Q,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(X,{dataKey:"yearLabel",className:"text-xs",tick:{fontSize:12}}),e.jsx(q,{className:"text-xs",tick:{fontSize:12},tickFormatter:u}),e.jsx(W,{content:e.jsx(j,{})}),e.jsx(ce,{}),e.jsx(H,{type:"monotone",dataKey:"actualHeight",stroke:"#3b82f6",strokeWidth:3,name:"Actual Height",dot:{r:4,fill:"#3b82f6"},connectNulls:!1}),e.jsx(H,{type:"monotone",dataKey:"predictedHeight",stroke:"#10b981",strokeWidth:2,name:"Predicted Height",dot:{r:3,fill:"#10b981"},strokeDasharray:"5 5"}),e.jsx(H,{type:"monotone",dataKey:"upperBound",stroke:"#94a3b8",strokeWidth:1,name:"Upper Bound",dot:!1,strokeDasharray:"2 2"}),e.jsx(H,{type:"monotone",dataKey:"lowerBound",stroke:"#94a3b8",strokeWidth:1,name:"Lower Bound",dot:!1,strokeDasharray:"2 2"})]})})]})},da=()=>{var n,d,o,h,f,b,k,S,w,A,D,P,T,K,L,_,O,R,F,Z,Y,ee;const{sidebarOpen:t,toggleSidebar:r,closeSidebar:a}=gt(),[s,c]=l.useState({}),{stats:i,loading:m,error:y,refresh:u}=ut(s),g=l.useCallback(N=>{c(N)},[]),j=N=>N?N.toLocaleString():"0",p=N=>N?`${N.toFixed(1)}%`:"0%",v=(N,z="SEK")=>N?new Intl.NumberFormat("sv-SE",{style:"currency",currency:z,minimumFractionDigits:0,maximumFractionDigits:0}).format(N):"0",x=(N,z="SEK")=>N?N>=1e6?`${(N/1e6).toFixed(1)}M ${z}`:N>=1e3?`${(N/1e3).toFixed(1)}K ${z}`:v(N,z):"0";return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[e.jsx(ft,{onToggleSidebar:r}),e.jsx(yt,{isOpen:t,onClose:a}),e.jsx("main",{className:"flex-1 p-4 md:p-6 lg:p-8 lg:ml-64",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{children:[e.jsx("nav",{className:"flex mb-2","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"flex items-center space-x-4",children:[e.jsx("li",{children:e.jsx(ne,{to:"/dashboard",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:"Overview"})}),e.jsx("li",{children:e.jsx("svg",{className:"flex-shrink-0 h-4 w-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:e.jsx("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})})}),e.jsx("li",{children:e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Financial Dashboard"})})]})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Financial Dashboard"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Investment performance, revenue analysis, and financial risk assessment for your forest portfolio."})]})})}),e.jsx(pt,{onFiltersChange:g}),m?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(ie,{text:"Loading financial data..."})}):y?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-8",children:[e.jsxs("p",{className:"text-red-600",children:["Error loading financial statistics: ",y]}),e.jsx("button",{onClick:u,className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Try again"})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Investment Performance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(ae,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),title:"Portfolio Value",value:x((d=(n=i==null?void 0:i.investor)==null?void 0:n.portfolio)==null?void 0:d.totalCurrentValue),subtitle:`${((h=(o=i==null?void 0:i.investor)==null?void 0:o.portfolio)==null?void 0:h.forestCount)||0} forests | Avg: ${x((b=(f=i==null?void 0:i.investor)==null?void 0:f.portfolio)==null?void 0:b.averageValue)}`,color:"green"}),e.jsx(ae,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),title:"Average ROI",value:p((S=(k=i==null?void 0:i.investor)==null?void 0:k.roi)==null?void 0:S.averageROI),subtitle:`Range: ${p((A=(w=i==null?void 0:i.investor)==null?void 0:w.roi)==null?void 0:A.minROI)} - ${p((P=(D=i==null?void 0:i.investor)==null?void 0:D.roi)==null?void 0:P.maxROI)}`,color:"blue"}),e.jsx(ae,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),title:"Carbon Credits",value:j((K=(T=i==null?void 0:i.investor)==null?void 0:T.carbonCredits)==null?void 0:K.totalAvailable),subtitle:`${j((_=(L=i==null?void 0:i.investor)==null?void 0:L.carbonCredits)==null?void 0:_.totalSold)} sold | ${v((R=(O=i==null?void 0:i.investor)==null?void 0:O.carbonCredits)==null?void 0:R.averagePrice)}/credit`,color:"green"}),e.jsx(ae,{icon:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),title:"Timber Value",value:x((Z=(F=i==null?void 0:i.investor)==null?void 0:F.timber)==null?void 0:Z.totalValue),subtitle:`${v((ee=(Y=i==null?void 0:i.investor)==null?void 0:Y.timber)==null?void 0:ee.averageValuePerTree)}/tree avg`,color:"orange"})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Revenue Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(qt,{filters:s,chartType:"bar"})}),e.jsx("div",{children:e.jsx(Xt,{filters:s,chartType:"bar"})})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Growth & Returns"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"col-span-1 lg:col-span-2",children:e.jsx(ye,{filters:s,chartType:"line"})}),e.jsx("div",{className:"col-span-1 lg:col-span-2",children:e.jsx(ye,{filters:s,chartType:"area"})})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Financial Risk Assessment"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Related Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(ne,{to:"/dashboard",className:"block",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 p-6 border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg mr-4",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Overview Dashboard"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Return to the main overview for quick insights across all metrics."})]})}),e.jsx(ne,{to:"/dashboard/ecological",className:"block",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 p-6 border border-gray-200 dark:border-gray-700 hover:border-green-300 dark:hover:border-green-600",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg mr-4",children:e.jsx("svg",{className:"h-5 w-5 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Ecological Dashboard"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Explore environmental impact and biodiversity metrics that affect long-term value."})]})})]})]})]})})]})};export{da as FinancialDashboardPage};
