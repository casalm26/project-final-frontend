import{A as I,f as P,r as c,j as e,L as O,b as L}from"./index-eAO8Bxia.js";import{u as T,D as M,a as A,G as B,t as R}from"./useSidebarState-4rBSpLs5.js";import"./vendor-BtP0CW_r.js";import"./DarkModeToggle-CEKHqJU9.js";import"./IconButton-CdxGDsQs.js";const m=new I,V={exportTreesCSV:(r={},a="trees_export.csv")=>m.downloadFile("/exports/trees/csv",r,a),exportTreesXLSX:(r={},a="trees_export.xlsx")=>m.downloadFile("/exports/trees/xlsx",r,a),exportForestAnalytics:(r={},a="forest_analytics.xlsx")=>m.downloadFile("/exports/forest-analytics",r,a),exportTrees:(r={})=>{const{format:a="csv",...g}=r,o=`trees_export_${new Date().toISOString().split("T")[0]}.${a}`,l=a==="xlsx"?"/exports/trees/xlsx":"/exports/trees/csv";return m.downloadFile(l,g,o)}},X=()=>{const{sidebarOpen:r,toggleSidebar:a,closeSidebar:g}=T(),{showToast:o}=P(),[l,w]=c.useState({}),[i,u]=c.useState("csv"),[n,f]=c.useState("filtered"),[d,k]=c.useState({basicInfo:!0,location:!0,health:!0,measurements:!0,images:!1,genetics:!1,growthModel:!1,maintenance:!1,economicValue:!1,canopy:!1,ecologicalBenefits:!1,environmentalFactors:!1,metadata:!1}),[h,j]=c.useState(!1),C=c.useCallback(t=>{w(t)},[]),y=t=>{k(s=>({...s,[t]:!s[t]}))},E=async()=>{j(!0);try{const t={format:i,scope:n,...d};if(n==="filtered"){const s=R(l);Object.assign(t,s)}await V.exportTrees(t),o("Export completed successfully!","success")}catch(t){console.error("Export failed:",t),o("Export failed. Please try again.","error")}finally{j(!1)}},S=()=>{var b,N,v;const t=Object.values(d).filter(p=>p).length;let s="all records";if(n==="filtered"&&(((b=l.selectedForests)==null?void 0:b.length)>0&&(s=`records from ${l.selectedForests.length} forest(s)`),(N=l.dateRange)!=null&&N.startDate&&((v=l.dateRange)!=null&&v.endDate))){const p=l.dateRange.startDate.toLocaleDateString(),D=l.dateRange.endDate.toLocaleDateString();s+=` between ${p} - ${D}`}return{includeCount:t,recordEstimate:s}},{includeCount:x,recordEstimate:F}=S();return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[e.jsx(M,{onToggleSidebar:a}),e.jsx(A,{isOpen:r,onClose:g}),e.jsx("main",{className:"flex-1 p-4 md:p-6 lg:p-8 lg:ml-64",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{children:[e.jsx("nav",{className:"flex mb-2","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"flex items-center space-x-4",children:[e.jsx("li",{children:e.jsx(O,{to:"/dashboard",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:"Overview"})}),e.jsx("li",{children:e.jsx("svg",{className:"flex-shrink-0 h-4 w-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:e.jsx("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})})}),e.jsx("li",{children:e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Data Export"})})]})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Data Export"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Export your tree data in various formats with customizable options"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Scope"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"all",checked:n==="all",onChange:t=>f(t.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsxs("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"All Data"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"Export entire database without any filters"})]})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"filtered",checked:n==="filtered",onChange:t=>f(t.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsxs("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Filtered Data"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"Export only data matching the filters below"})]})]})]})]}),n==="filtered"&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:e.jsx(B,{onFiltersChange:C})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Data Fields to Include"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-md font-medium text-gray-800 dark:text-gray-200 mb-3",children:"Basic Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries({basicInfo:"Basic Info (ID, Species, Forest)",location:"Location (Coordinates)",health:"Health Status",measurements:"Measurements (Height, Diameter, CO₂)",images:"Image URLs"}).map(([t,s])=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:d[t],onChange:()=>y(t),className:"w-4 h-4 text-green-600 rounded focus:ring-green-500"}),e.jsx("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:s})]},t))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium text-gray-800 dark:text-gray-200 mb-3",children:"Advanced Data"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries({genetics:"Genetics (Seed Source, Cultivar, Diversity)",growthModel:"Growth Model (Predictions, Rate, Index)",maintenance:"Maintenance (Fertilization, Pruning, Damage)",economicValue:"Economic Value (Timber, Carbon Credits)",canopy:"Canopy (Area, Density, Condition)",ecologicalBenefits:"Ecological Benefits (CO₂, Pollutants, Wildlife)",environmentalFactors:"Environmental (Climate, Site, Position)",metadata:"Metadata (Planting Method, Timestamps)"}).map(([t,s])=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:d[t],onChange:()=>y(t),className:"w-4 h-4 text-green-600 rounded focus:ring-green-500"}),e.jsx("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:s})]},t))})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Format"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",style:{borderColor:i==="csv"?"#10b981":"#e5e7eb"},children:[e.jsx("input",{type:"radio",value:"csv",checked:i==="csv",onChange:t=>u(t.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"CSV"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"Comma-separated values, compatible with Excel"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",style:{borderColor:i==="xlsx"?"#10b981":"#e5e7eb"},children:[e.jsx("input",{type:"radio",value:"xlsx",checked:i==="xlsx",onChange:t=>u(t.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"Excel (XLSX)"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"Native Excel format with formatting"})]})]})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 sticky top-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Preview"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Format:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white uppercase",children:i})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Scope:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white capitalize",children:n})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Fields:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[x," selected"]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Exporting:"}),e.jsx("span",{className:"block font-medium text-gray-900 dark:text-white mt-1",children:F})]})]}),e.jsx("button",{onClick:E,disabled:h||x===0,className:`w-full py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center ${h||x===0?"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:h?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"small",className:"mr-2"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Data"]})}),x===0&&e.jsx("p",{className:"mt-3 text-sm text-red-600 dark:text-red-400",children:"Please select at least one field to export"})]})})]})]})})]})};export{X as ExportPage};
